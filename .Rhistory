gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id)
, fill = '#f8f8f8', color = '#999999'
, size = 0.15, show.legend = F)
} else {
map$flag <- ifelse(map$id %in% highlight_states, TRUE, FALSE)
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id, fill = map$flag)
, color = '#999999', size = 0.15, show.legend = F) +
scale_fill_manual(values = c('#f8f8f8', '#cccccc'))
}
gg <- gg +
geom_point(data = reserve_locations, aes(x = Longitude, y = Latitude)
, fill = '#444e65', shape = 21, size = 1)
gg
dev.off()
gg
dev.off()
map <- ggplot2::fortify(us_aea_mod, region = "GEO_ID")
reserve_locations <- reserve_locs(incl = incl)
highlight_reserves <- reserve_locs(incl = incl)
# plot it----
# highlight some states
gg <- ggplot()
gg <- gg + coord_equal()
gg <- gg + ggthemes::theme_map()
gg <- gg + theme(plot.margin = unit(c(0, 0, 0, 0), "points")) #trbl
if(is.null(highlight_states)) {
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id)
, fill = '#f8f8f8', color = '#999999'
, size = 0.15, show.legend = F)
} else {
map$flag <- ifelse(map$id %in% highlight_states, TRUE, FALSE)
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id, fill = map$flag)
, color = '#999999', size = 0.15, show.legend = F) +
scale_fill_manual(values = c('#f8f8f8', '#cccccc'))
}
gg <- gg +
geom_point(data = reserve_locations, aes(x = Longitude, y = Latitude)
, fill = '#444e65', shape = 21, size = 1)
gg
View(reserve_locations)
devtools::load_all(".")
map <- ggplot2::fortify(us_aea_mod, region = "GEO_ID")
reserve_locations <- reserve_locs(incl = incl)
highlight_reserves <- reserve_locs(incl = incl)
# plot it----
# highlight some states
gg <- ggplot()
gg <- gg + coord_equal()
gg <- gg + ggthemes::theme_map()
gg <- gg + theme(plot.margin = unit(c(0, 0, 0, 0), "points")) #trbl
if(is.null(highlight_states)) {
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id)
, fill = '#f8f8f8', color = '#999999'
, size = 0.15, show.legend = F)
} else {
map$flag <- ifelse(map$id %in% highlight_states, TRUE, FALSE)
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id, fill = map$flag)
, color = '#999999', size = 0.15, show.legend = F) +
scale_fill_manual(values = c('#f8f8f8', '#cccccc'))
}
gg <- gg +
geom_point(data = reserve_locations, aes(x = Longitude, y = Latitude)
, fill = '#444e65', shape = 21, size = 1)
gg
devtools::load_all(".")
gg
devtools::load_all(".")
map <- ggplot2::fortify(us_aea_mod, region = "GEO_ID")
reserve_locations <- reserve_locs(incl = incl)
highlight_reserves <- reserve_locs(incl = incl)
# plot it----
# highlight some states
gg <- ggplot()
gg <- gg + coord_equal()
gg <- gg + ggthemes::theme_map()
gg <- gg + theme(plot.margin = unit(c(0, 0, 0, 0), "points")) #trbl
if(is.null(highlight_states)) {
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id)
, fill = '#f8f8f8', color = '#999999'
, size = 0.15, show.legend = F)
} else {
map$flag <- ifelse(map$id %in% highlight_states, TRUE, FALSE)
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id, fill = map$flag)
, color = '#999999', size = 0.15, show.legend = F) +
scale_fill_manual(values = c('#f8f8f8', '#cccccc'))
}
gg <- gg +
geom_point(data = reserve_locations, aes(x = Longitude, y = Latitude)
, fill = '#444e65', shape = 21, size = 1)
gg
devtools::load_all(".")
map <- ggplot2::fortify(us_aea_mod, region = "GEO_ID")
reserve_locations <- reserve_locs(incl = incl)
highlight_reserves <- reserve_locs(incl = incl)
# plot it----
# highlight some states
gg <- ggplot()
gg <- gg + coord_equal()
gg <- gg + ggthemes::theme_map()
gg <- gg + theme(plot.margin = unit(c(0, 0, 0, 0), "points")) #trbl
if(is.null(highlight_states)) {
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id)
, fill = '#f8f8f8', color = '#999999'
, size = 0.15, show.legend = F)
} else {
map$flag <- ifelse(map$id %in% highlight_states, TRUE, FALSE)
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id, fill = map$flag)
, color = '#999999', size = 0.15, show.legend = F) +
scale_fill_manual(values = c('#f8f8f8', '#cccccc'))
}
gg <- gg +
geom_point(data = reserve_locations, aes(x = Longitude, y = Latitude)
, fill = '#444e65', shape = 21, size = 1)
gg
devtools::load_all(".")
map <- ggplot2::fortify(us_aea_mod, region = "GEO_ID")
reserve_locations <- reserve_locs(incl = incl)
highlight_reserves <- reserve_locs(incl = incl)
# plot it----
# highlight some states
gg <- ggplot()
gg <- gg + coord_equal()
gg <- gg + ggthemes::theme_map()
gg <- gg + theme(plot.margin = unit(c(0, 0, 0, 0), "points")) #trbl
if(is.null(highlight_states)) {
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id)
, fill = '#f8f8f8', color = '#999999'
, size = 0.15, show.legend = F)
} else {
map$flag <- ifelse(map$id %in% highlight_states, TRUE, FALSE)
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id, fill = map$flag)
, color = '#999999', size = 0.15, show.legend = F) +
scale_fill_manual(values = c('#f8f8f8', '#cccccc'))
}
gg <- gg +
geom_point(data = reserve_locations, aes(x = Longitude, y = Latitude)
, fill = '#444e65', shape = 21, size = 1)
dev.off()
gg
gg
devtools::load_all(".")
map <- ggplot2::fortify(us_aea_mod, region = "GEO_ID")
reserve_locations <- reserve_locs(incl = incl)
highlight_reserves <- reserve_locs(incl = incl)
# plot it----
# highlight some states
gg <- ggplot()
gg <- gg + coord_equal()
gg <- gg + ggthemes::theme_map()
gg <- gg + theme(plot.margin = unit(c(0, 0, 0, 0), "points")) #trbl
if(is.null(highlight_states)) {
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id)
, fill = '#f8f8f8', color = '#999999'
, size = 0.15, show.legend = F)
} else {
map$flag <- ifelse(map$id %in% highlight_states, TRUE, FALSE)
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id, fill = map$flag)
, color = '#999999', size = 0.15, show.legend = F) +
scale_fill_manual(values = c('#f8f8f8', '#cccccc'))
}
gg <- gg +
geom_point(data = reserve_locations, aes(x = Longitude, y = Latitude)
, fill = '#444e65', shape = 21, size = 1)
gg
gg
gg
print(gg)
devtools::load_all(".")
map <- ggplot2::fortify(us_aea_mod, region = "GEO_ID")
reserve_locations <- reserve_locs(incl = incl)
highlight_reserves <- reserve_locs(incl = incl)
# plot it----
# highlight some states
gg <- ggplot()
gg <- gg + coord_equal()
gg <- gg + ggthemes::theme_map()
gg <- gg + theme(plot.margin = unit(c(0, 0, 0, 0), "points")) #trbl
if(is.null(highlight_states)) {
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id)
, fill = '#f8f8f8', color = '#999999'
, size = 0.15, show.legend = F)
} else {
map$flag <- ifelse(map$id %in% highlight_states, TRUE, FALSE)
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id, fill = map$flag)
, color = '#999999', size = 0.15, show.legend = F) +
scale_fill_manual(values = c('#f8f8f8', '#cccccc'))
}
gg <- gg +
geom_point(data = reserve_locations, aes(x = Longitude, y = Latitude)
, fill = '#444e65', shape = 21, size = 1)
print(gg)
print(gg)
devtools::load_all(".")
map <- ggplot2::fortify(us_aea_mod, region = "GEO_ID")
reserve_locations <- reserve_locs(incl = incl)
highlight_reserves <- reserve_locs(incl = incl)
# plot it----
# highlight some states
gg <- ggplot()
gg <- gg + coord_equal()
gg <- gg + ggthemes::theme_map()
gg <- gg + theme(plot.margin = unit(c(0, 0, 0, 0), "points")) #trbl
if(is.null(highlight_states)) {
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id)
, fill = '#f8f8f8', color = '#999999'
, size = 0.15, show.legend = F)
} else {
map$flag <- ifelse(map$id %in% highlight_states, TRUE, FALSE)
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id, fill = map$flag)
, color = '#999999', size = 0.15, show.legend = F) +
scale_fill_manual(values = c('#f8f8f8', '#cccccc'))
}
gg <- gg +
geom_point(data = reserve_locations, aes(x = Longitude, y = Latitude)
, fill = '#444e65', shape = 21, size = 1)
gg
devtools::load_all(".")
map <- ggplot2::fortify(us_aea_mod, region = "GEO_ID")
reserve_locations <- reserve_locs(incl = incl)
highlight_reserves <- reserve_locs(incl = incl)
# plot it----
# highlight some states
gg <- ggplot()
gg <- gg + coord_equal()
gg <- gg + ggthemes::theme_map()
gg <- gg + theme(plot.margin = unit(c(0, 0, 0, 0), "points")) #trbl
if(is.null(highlight_states)) {
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id)
, fill = '#f8f8f8', color = '#999999'
, size = 0.15, show.legend = F)
} else {
map$flag <- ifelse(map$id %in% highlight_states, TRUE, FALSE)
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id, fill = map$flag)
, color = '#999999', size = 0.15, show.legend = F) +
scale_fill_manual(values = c('#f8f8f8', '#cccccc'))
}
gg <- gg +
geom_point(data = reserve_locations, aes(x = Longitude, y = Latitude)
, fill = '#444e65', shape = 21, size = 1)
gg
gg
View(sampling_stations)
loc_mod <- reserve_locs(incl = c('contig', 'AK', 'HI', 'PR'))
devtools::load_all(".")
chk <- highlight_locs(reserve_subset = c('ace', 'kac', 'job', 'elk'))
devtools::load_all(".")
chk <- highlight_locs(reserve_subset = c('ace', 'kac', 'job', 'elk'))
devtools::load_all(".")
chk <- highlight_locs(reserve_subset = c('ace', 'kac', 'job', 'elk'))
devtools::load_all(".")
chk <- highlight_locs(reserve_subset = c('ace', 'kac', 'job', 'elk'))
devtools::load_all(".")
chk <- highlight_locs(reserve_subset = c('ace', 'kac', 'job', 'elk'))
devtools::document
devtools::document()
devtools:;document()
devtools::document()
chk <- highlight_locs(reserve_subset = c('ace', 'kac', 'job', 'elk'))
devtools::document()
chk <- highlight_locs(subset_reserve = c('kac', 'elk', 'job'))
View(chk)
!is.null(highlight_reserves)
highlight_reserves
highlight_reserves <- c('kac', 'elk', 'ace')
if(!is.null(highlight_reserves)) highlight_locations <- highlight_locs(subset_reserve =  highlight_reserves)
# highlight some states
gg <- ggplot()
gg <- gg + coord_equal()
gg <- gg + ggthemes::theme_map()
gg <- gg + theme(plot.margin = unit(c(0, 0, 0, 0), "points")) #trbl
if(is.null(highlight_states)) {
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id)
, fill = '#f8f8f8', color = '#999999'
, size = 0.15, show.legend = F)
} else {
map$flag <- ifelse(map$id %in% highlight_states, TRUE, FALSE)
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id, fill = map$flag)
, color = '#999999', size = 0.15, show.legend = F) +
scale_fill_manual(values = c('#f8f8f8', '#cccccc'))
}
# add reserve locations
gg <- gg +
geom_point(data = reserve_locations, aes(x = Longitude, y = Latitude)
, fill = '#444e65', shape = 21, size = 1)
# add highlighted reserves, if specified
if(!is.null(highlight_reserves)) {
highlight_locations <- highlight_locs(subset_reserve =  highlight_reserves)
gg + geom_point(data = highlight_locations, aes(x = Longitude, y = Latitude)
, fill = 'yellow', shape = 21, size = 2)
}
gg
# highlight some states
gg <- ggplot()
gg <- gg + coord_equal()
gg <- gg + ggthemes::theme_map()
gg <- gg + theme(plot.margin = unit(c(0, 0, 0, 0), "points")) #trbl
if(is.null(highlight_states)) {
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id)
, fill = '#f8f8f8', color = '#999999'
, size = 0.15, show.legend = F)
} else {
map$flag <- ifelse(map$id %in% highlight_states, TRUE, FALSE)
gg <- gg + geom_map(data = map, map = map
, aes(map$long, map$lat, map_id = map$id, fill = map$flag)
, color = '#999999', size = 0.15, show.legend = F) +
scale_fill_manual(values = c('#f8f8f8', '#cccccc'))
}
# add reserve locations
gg <- gg +
geom_point(data = reserve_locations, aes(x = Longitude, y = Latitude)
, fill = '#444e65', shape = 21, size = 1)
# add highlighted reserves, if specified
if(!is.null(highlight_reserves)) {
highlight_locations <- highlight_locs(subset_reserve =  highlight_reserves)
gg + geom_point(data = highlight_locations, aes(x = Longitude, y = Latitude)
, fill = 'yellow', shape = 21, size = 2)
}
devtools::load_all(".")
nerr_states_west <- c('02', '06', '41', '53')
nerrs_codes <- c('pdb', 'sos', 'sfb', 'elk', 'tjr', 'kac')
x <- res_national_map(highlight_states = nerr_states_west, highlight_reserve = nerrs_codes)
x
devtools::load_all(".")
devtools::load_all(".")
nerr_states_west <- c('02', '06', '41', '53')
nerrs_codes <- c('pdb', 'sos', 'sfb', 'elk', 'tjr', 'kac')
x <- res_national_map(highlight_states = nerr_states_west, highlight_reserve = nerrs_codes)
x
devtools::document()
devtools::document()
devtools::load_all(".")
devtools::load_all(".")
?map_reserve
View(sampling_stations)
reserves <-c('ace', 'niw', 'gnd', 'owc', 'gtm', 'pdb', 'wqb', 'sfb')
?res_national_map
x <- res_national_map(highlight_reserves = reserves)
x
x
x <- res_national_map()
x
devtools::load_all(".")
x <- res_national_map(highlight_reserves = reserves)
x
devtools::load_all(".")
x <- res_national_map(highlight_reserves = reserves)
x
devtools::load_all(".")
x <- res_national_map(highlight_reserves = reserves)
x
devtools::load_all(".")
x <- res_national_map(highlight_reserves = reserves)
x
devtools::load_all(".")
x <- res_national_map(highlight_reserves = reserves)
View(x)
devtools::load_all(".")
x <- res_national_map(highlight_reserves = reserves)
x
x <- res_national_map(highlight_reserves = reserves)
x
devtools::load_all(".")
x <- res_national_map(highlight_reserves = reserves)
x
devtools::load_all(".")
x <- res_national_map(highlight_reserves = reserves)
x
devtools::load_all(".")
x <- res_national_map(highlight_reserves = reserves)
x
devtools::load_all(".")
devtools::load_all(".")
x <- res_national_map(highlight_reserves = reserves)
x
?geom_map
get_US_county_2010_shape <- function() {
dir <- tempdir()
utils::download.file("http://www2.census.gov/geo/tiger/GENZ2010/gz_2010_us_050_00_20m.zip", destfile = file.path(dir, "gz_2010_us_050_00_20m.zip"))
unzip(file.path(dir, "gz_2010_us_050_00_20m.zip"), exdir = dir)
rgdal::readOGR(file.path(dir, "gz_2010_us_050_00_20m.shp"))
}
us <- get_US_county_2010_shape()
# loc <- get('sampling_stations')
# convert it to Albers equal area
us_aea <- sp::spTransform(us, sp::CRS("+proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m +no_defs"))
us_aea@data$id <- rownames(us_aea@data)
# remove old states and put new ones back in
us_aea_mod <- us_aea[!us_aea$STATE %in% c("02", "15", "72"),]
if('AK' %in% incl) {
# extract, then rotate, shrink & move alaska (and reset projection)
# need to use state IDs via # https://www.census.gov/geo/reference/ansi_statetables.html
alaska <- us_aea[us_aea$STATE == "02", ]
alaska <- maptools::elide(alaska, rotate = -50)
alaska <- maptools::elide(alaska, scale = max(apply(sp::bbox(alaska), 1, diff)) / 2.3)
alaska <- maptools::elide(alaska, shift = c(-2100000, -2500000))
sp::proj4string(alaska) <- sp::proj4string(us_aea)
us_aea_mod <- maptools::spRbind(us_aea_mod, alaska)
}
if('HI' %in% incl) {
# extract, then rotate & shift hawaii
hawaii <- us_aea[us_aea$STATE == "15",]
hawaii <- maptools::elide(hawaii, rotate = -35)
hawaii <- maptools::elide(hawaii, shift=c(5400000, -1400000))
sp::proj4string(hawaii) <- sp::proj4string(us_aea)
us_aea_mod <- maptools::spRbind(us_aea_mod, hawaii)
}
if('PR' %in% incl) {
# extract, then rotate & shift pr
pr <- us_aea[us_aea$STATE == "72", ]
pr <- maptools::elide(pr, shift = c(-1400000,2000))
sp::proj4string(pr) <- sp::proj4string(us_aea)
us_aea_mod <- maptools::spRbind(us_aea_mod, pr)
}
if(agg_county) {
us_aea.diss <- maptools::unionSpatialPolygons(us_aea_mod, IDs = us_aea_mod@data$STATE)
us_aea_mod <- us_aea.diss
}
# get ready for ggplotting it... this takes a cpl seconds ----
map <- ggplot2::fortify(us_aea_mod, region = "GEO_ID")
# Prep reserve locations for plotting
reserve_locations <- reserve_locs(incl = incl)
# plot it----
# highlight some states
gg <- ggplot()
gg <- gg + coord_equal()
gg <- gg + ggthemes::theme_map()
gg <- gg + theme(plot.margin = unit(c(0, 0, 0, 0), "points")) #trbl
gg <- gg + geom_map(data = map, map = map
, aes_string('long', 'lat', map_id = 'map_id')
# , aes(map$long, map$lat, map_id = map$id)
, fill = '#f8f8f8', color = '#999999'
, size = 0.15, show.legend = F)
gg
devtools::load_all(".")
reserves <- c('ace', 'niw', 'gnd', 'owc', 'gtm', 'pdb', 'wqb', 'sfb')
x <- res_national_map(highlight_reserves = reserves)
x
?get_sites
get_sites
View(sampling_stations)
sampling_locations[(sampling_locations$NERR.Site.ID == 'elk', sampling_locations$Status = 'Active'), ]
sampling_locations[(sampling_locations$NERR.Site.ID == 'elk'& sampling_locations$Status = 'Active'), ]
sampling_stations[(sampling_stations$NERR.Site.ID == 'elk'& sampling_stations$Status = 'Active'), ]
sampling_stations[(sampling_stations$NERR.Site.ID == 'elk' & sampling_stations$Status == 'Active'), ]
sampling_stations[(sampling_stations$NERR.Site.ID == 'elk' & sampling_stations$Status == 'Active'), ]$Station.Code
loc_cbm <- sampling_stations[(sampling_stations$NERR.Site.ID == 'cbm' & sampling_stations$Status == 'Active'), ]$Station.Code
View(sampling_stations)
loc <- get('sampling_stations')
loc <- loc[(loc$Station.Code %in% stations), ]
stations <- sampling_stations[(sampling_stations$NERR.Site.ID == 'elk' & sampling_stations$Status == 'Active'), ]$Station.Code
loc <- get('sampling_stations')
loc <- loc[(loc$Station.Code %in% stations), ]
View(loc)
View(loc)
loc <- unique(loc[ , Latitude, Longitude])
loc <- unique(loc[ , c('Latitude', 'Longitude')])
load_shp_file <- function(path, shp_name){
x <- list.files(path = gis.file.loc, pattern = '.shp$')
shp <- rgdal::readOGR(dsn = paste(loc, '/', get_shp_name(loc), sep = '')) %>%
sp::spTransform(CRS("+proj=longlat +datum=WGS84"))
shp.diss <-maptools::unionSpatialPolygons(shp, IDs = rep('x', length(slot(shp, 'polygons'))))
return(shp)
}
devtools::load_all(".")
devtools::document()
data_location <- paste('data/spatial/GIS_Process/', nerrs_id, '/Boundaries/Reserve_Boundaries, sep = '')
shp <- 'ELK_RB_2000.shp'
x <- load_shp_file(path = data_location, shp_name = shp)
data_location <- paste('data/spatial/GIS_Process/', nerrs_id, '/Boundaries/Reserve_Boundaries', sep = '')
nerrs_id <- 'elk'
data_location <- paste('data/spatial/GIS_Process/', nerrs_id, '/Boundaries/Reserve_Boundaries', sep = '')
shp <- 'ELK_RB_2000.shp'
x <- load_shp_file(path = data_location, shp_name = shp)
devtools::load_all(".")
install.packages('rdgal')
devtools::load_all(".")
library(rgdal)
x <- load_shp_file(path = data_location, shp_name = shp)
devtools::load_all(".")
devtools::load_all(".")
devtools::document()
devtools::load_all(".")
x <- load_shp_file(path = data_location, shp_name = shp)
devtools::load_all(".")
x <- load_shp_file(path = data_location, shp_name = shp)
loc <- paste(data_location, '/', shp, sep = '')
loc
devtools::load_all(".")
x <- load_shp_file(path = data_location)
