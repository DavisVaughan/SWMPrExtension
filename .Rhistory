dat <- dat %>% dplyr::select(.data$datetimestamp, date, !!parm)
dat <- dat %>% dplyr::filter(!is.na(!! parm))
# Determine min/max/mean for each day
dat_all <- dat %>%
dplyr::group_by(!! dt) %>%
dplyr::summarise(mean = mean(!! parm, na.rm = TRUE)
, min = min(!! parm, na.rm = TRUE)
, max = max(!! parm, na.rm = TRUE))
library(dplyr)
if(attr(dat, 'qaqc_cols'))
warning('QAQC columns present. QAQC not performed before analysis.')
# Filter to historic range and target year
dat <- dat %>% dplyr::filter(lubridate::year(.data$datetimestamp) == target_yr |
dplyr::between(lubridate::year(.data$datetimestamp),as.numeric(rng[[1]]), as.numeric(rng[[2]])))
# dat <- dat %>% dplyr::filter(lubridate::year(.data$datetimestamp) >= rng[[1]]
#                              & lubridate::year(.data$datetimestamp) <= rng[[2]])
# Assign date for determining daily stat value
dat$date <- lubridate::floor_date(dat$datetimestamp, unit = 'days')
# Filter for parameter of interest and remove NA values
dat <- dat %>% dplyr::select(.data$datetimestamp, date, !!parm)
dat <- dat %>% dplyr::filter(!is.na(!! parm))
# Determine min/max/mean for each day
dat_all <- dat %>%
dplyr::group_by(!! dt) %>%
dplyr::summarise(mean = mean(!! parm, na.rm = TRUE)
, min = min(!! parm, na.rm = TRUE)
, max = max(!! parm, na.rm = TRUE))
View(dat_all)
View(dat)
# Assign seasons
dat_all$season <- assign_season(dat_all$date, ...)
# Assign seasons
dat_all$season <- assign_season(dat_all$date)#, ...)
# separate into historical and target year data.frames
dat_yr <- dat_all %>% dplyr::filter(lubridate::year(date) == target_yr)
dat_all <- dat_all %>%
dplyr::filter(dplyr::between(lubridate::year(.data$date), as.numeric(rng[[1]]), as.numeric(rng[[2]])))
View(dat_all)
View(dat_all)
View(dat_yr)
seas
dat_hist <- dat_all %>%
dplyr::group_by(!! seas) %>%
dplyr::summarise(mean = mean(!! avg, na.rm = T)
, min = mean(!!  mini, na.rm = T)
, max = mean(!! maxi, na.rm = T))
View(dat_hist)
chk <- dat_all %>% filter(season == 'January')
View(dat_all)
chk <- dat_all %>% filter(season == 'Jan')
View(chk)
avg
mini
maxi
chk %>%
dplyr::group_by(!! seas) %>%
dplyr::summarise(mean = mean(!! avg, na.rm = T)
, min = mean(!!  mini, na.rm = T)
, max = mean(!! maxi, na.rm = T))
chk
chk <- dat_all %>% filter(season == 'May')
View(chk)
View(dat_all)
devtools::load_all(".")
historical_range(dat_nut, param = 'nh4f', target_yr = 2013)
devtools::load_all(".")
historical_range(dat_nut, param = 'nh4f', target_yr = 2013)
library(SWMPrExtension)
devtools::load_all(".")
historical_range(dat, param = 'do_mgl', target_yr = 2013, criteria = 2)
library(SWMPrExtension)
historical_range(dat, param = 'do_mgl', target_yr = 2013, criteria = 2)
devtools::load_all(".")
historical_range(dat, param = 'do_mgl', target_yr = 2013, criteria = 2)
data(elksmwq)
dat <- qaqc(elksmwq, qaqc_keep = c('0', '3', '5'))
historical_range(dat, param = 'do_mgl', target_yr = 2013, criteria = 2)
devtools::load_all(".")
historical_range(dat, param = 'do_mgl', target_yr = 2013, criteria = 2)
devtools::load_all(".")
historical_range(dat, param = 'do_mgl', target_yr = 2013, criteria = 2)
devtools::load_all(".")
historical_range(dat, param = 'do_mgl', target_yr = 2013, criteria = 2)
devtools::load_all(".")
historical_range(dat, param = 'do_mgl', target_yr = 2013, criteria = 2)
devtools::load_all(".")
historical_range(dat, param = 'do_mgl', target_yr = 2013, criteria = 2)
devtools::load_all(".")
historical_range(dat, param = 'do_mgl', target_yr = 2013, criteria = 2)
devtools::load_all(".")
historical_range(dat, param = 'do_mgl', target_yr = 2013, criteria = 2)
devtools::load_all(".")
historical_range(dat, param = 'do_mgl', target_yr = 2013)
devtools::load_all(".")
historical_range(dat, param = 'do_mgl', target_yr = 2013)
?invert
devtools::load_all(".")
data(elknmnut)
dat_nut <- qaqc(elknmnut, qaqc_keep = c('0', '3', '5'))
dat_nut <- rem_reps(dat_nut)
historical_range(dat_nut, param = 'nh4f', target_yr = 2013)
devtools::load_all(".")
historical_range(dat_nut, param = 'nh4f', target_yr = 2013)
devtools::load_all(".")
devtools::load_all(".")
data(elksmwq)
dat <- qaqc(elksmwq, qaqc_keep = c('0', '3', '5'))
historical_range(dat, param = 'do_mgl', target_yr = 2013, criteria = 2)
historical_range(dat, param = 'do_mgl', target_yr = 2013, hist_rng = c(2014, 2016), criteria = 2)
historical_range(dat, param = 'do_mgl', target_yr = 2013)
historical_range(dat, param = 'do_mgl', target_yr = 2013, hist_rng = c(2014, 2016), criteria = 2)
historical_range(dat, param = 'do_mgl', target_yr = 2013, hist_rng = c(2014, 2016))
historical_range(dat, param = 'do_mgl', target_yr = 2016, hist_rng = c(2013, 2014), criteria = 2)
data(elknmnut)
dat_nut <- qaqc(elknmnut, qaqc_keep = c('0', '3', '5'))
dat_nut <- rem_reps(dat_nut)
historical_range(dat_nut, param = 'nh4f', target_yr = 2013)
?orride.aes
?override.aes
devtools::load_all(".")
historical_range(dat_nut, param = 'nh4f', target_yr = 2013)
devtools::load_all(".")
library(SWMPrExtension)
?res_custom_map
?res_custom_sk_map
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
x_coords <- c(-121.735281, -121.750369)
y_coords <- c(36.850377, 36.806667)
shp_fl <- elk_spatial
bounding_elk <- c(-121.810978, 36.868218, -121.708667, 36.764050)
lab_dir <- c('R', 'L')
trnds <- c('inc', 'dec')
pos <- 'bottomleft'
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
left_labs <- grep('L', lab_loc)
lab_dir
lab_loc <- lab_dir
left_labs <- grep('L', lab_loc)
right_labs <- grep('R', lab_loc)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
m <- m %>%
addLabelOnlyMarkers(lng = ~Longitude[right_labs] * -1, lat = ~Latitude[right_labs]
, label = loc$abbrev[right_labs]
, labelOptions = labelOptions(noHide = station_labs
, direction = c('right')
, opacity = 1
, offset = c(10, 0)
, style = label_style))
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
x_coords <- c(-121.735281, -121.750369)
y_coords <- c(36.850377, 36.806667)
shp_fl <- elk_spatial
bounding_elk <- c(-121.810978, 36.868218, -121.708667, 36.764050)
lab_dir <- c('R', 'R')
trnds <- c('inc', 'dec')
pos <- 'bottomleft'
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
library(SWMPrExtension)
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
x_coords <- c(-121.735281, -121.750369)
y_coords <- c(36.850377, 36.806667)
shp_fl <- elk_spatial
bounding_elk <- c(-121.810978, 36.868218, -121.708667, 36.764050)
lab_dir <- c('R', 'R')
trnds <- c('inc', 'dec')
pos <- 'bottomleft'
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
x_coords <- c(-121.735281, -121.750369)
y_coords <- c(36.850377, 36.806667)
shp_fl <- elk_spatial
bounding_elk <- c(-121.810978, 36.868218, -121.708667, 36.764050)
lab_dir <- c('L', 'R')
trnds <- c('inc', 'dec')
pos <- 'bottomleft'
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
x_coords <- c(-121.735281, -121.750369)
y_coords <- c(36.850377, 36.806667)
shp_fl <- elk_spatial
bounding_elk <- c(-121.810978, 36.868218, -121.708667, 36.764050)
lab_dir <- c('L', 'L')
trnds <- c('inc', 'dec')
pos <- 'bottomleft'
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
grep('L', c('R', 'L'))
devtools::load_all(".")
devtools::load_all(".")
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
x_coords <- c(-121.735281, -121.750369)
y_coords <- c(36.850377, 36.806667)
shp_fl <- elk_spatial
bounding_elk <- c(-121.810978, 36.868218, -121.708667, 36.764050)
lab_dir <- c('L', 'L')
trnds <- c('inc', 'dec')
pos <- 'bottomleft'
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
x_coords <- c(-121.735281, -121.750369)
y_coords <- c(36.850377, 36.806667)
shp_fl <- elk_spatial
bounding_elk <- c(-121.810978, 36.868218, -121.708667, 36.764050)
lab_dir <- c('R', 'L')
trnds <- c('inc', 'dec')
pos <- 'bottomleft'
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
x_coords <- c(-121.735281, -121.750369)
y_coords <- c(36.850377, 36.806667)
shp_fl <- elk_spatial
bounding_elk <- c(-121.810978, 36.868218, -121.708667, 36.764050)
lab_dir <- c('R', 'R')
trnds <- c('inc', 'dec')
pos <- 'bottomleft'
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
x_coords <- c(-121.735281, -121.750369)
y_coords <- c(36.850377, 36.806667)
shp_fl <- elk_spatial
bounding_elk <- c(-121.810978, 36.868218, -121.708667, 36.764050)
lab_dir <- c('R', 'R')
trnds <- c('inc', 'dec')
pos <- 'bottomleft'
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
### plot
x <- res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
exists(x)
exists('x')
length(x)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
lab_dir <- c('L', 'L')
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
trnds
stns
x_coords
y_coords
pos
bounding_elk
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
rm(lab_loc)
devtools::load_all(".")
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
x_coords <- c(-121.735281, -121.750369)
y_coords <- c(36.850377, 36.806667)
shp_fl <- elk_spatial
bounding_elk <- c(-121.810978, 36.868218, -121.708667, 36.764050)
lab_dir <- c('L', 'L')
trnds <- c('inc', 'dec')
pos <- 'bottomleft'
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, #lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
x_coords <- c(-121.735281, -121.750369)
y_coords <- c(36.850377, 36.806667)
shp_fl <- elk_spatial
bounding_elk <- c(-121.810978, 36.868218, -121.708667, 36.764050)
lab_dir <- c('L', 'L')
trnds <- c('inc', 'dec')
pos <- 'bottomleft'
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
x_coords <- c(-121.735281, -121.750369)
y_coords <- c(36.850377, 36.806667)
shp_fl <- elk_spatial
bounding_elk <- c(-121.810978, 36.868218, -121.708667, 36.764050)
lab_dir <- c('L', 'L')
trnds <- c('inc', 'dec')
pos <- 'bottomleft'
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
x_coords <- c(-121.735281, -121.750369)
y_coords <- c(36.850377, 36.806667)
shp_fl <- elk_spatial
bounding_elk <- c(-121.810978, 36.868218, -121.708667, 36.764050)
lab_dir <- c('L', 'R')
trnds <- c('inc', 'dec')
pos <- 'bottomleft'
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
### set plotting parameters
stns <- c('custom stn 1', 'custom stn 2')
x_coords <- c(-121.735281, -121.750369)
y_coords <- c(36.850377, 36.806667)
shp_fl <- elk_spatial
bounding_elk <- c(-121.810978, 36.868218, -121.708667, 36.764050)
lab_dir <- c('R', 'R')
trnds <- c('inc', 'dec')
pos <- 'bottomleft'
### plot
res_custom_sk_map(stations = stns, x_loc = x_coords,
sk_result = trnds, y_loc = y_coords,
bbox = bounding_elk, lab_loc = lab_dir,
scale_pos = pos, shp = shp_fl)
devtools::load_all(".")
?create_sk_flextable_list
